<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNA Tandem Repeat Encoder-Decoder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .tab-button.active { 
            background-color: #3b82f6; 
            color: white; 
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="gradient-bg text-white py-8">
        <div class="container mx-auto px-4">
            <h1 class="text-4xl font-bold text-center mb-2">DNA Tandem Repeat Encoder-Decoder</h1>
            <p class="text-center text-lg opacity-90">Advanced genomic sequence analysis with numerical encoding</p>
        </div>
    </div>

    <div class="container mx-auto px-4 py-8">
        <!-- Tab Navigation -->
        <div class="flex flex-wrap justify-center mb-8 bg-white rounded-lg shadow-lg p-2">
            <button onclick="showTab('encode')" class="tab-button active px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:bg-blue-100 mr-2 mb-2">
                Encode
            </button>
            <button onclick="showTab('decode')" class="tab-button px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:bg-blue-100 mr-2 mb-2">
                Decode
            </button>
            <button onclick="showTab('validate')" class="tab-button px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:bg-blue-100 mr-2 mb-2">
                Validate
            </button>
            <button onclick="showTab('mutant')" class="tab-button px-6 py-3 rounded-lg font-semibold transition-all duration-200 hover:bg-blue-100 mb-2">
                Mutant
            </button>
        </div>

        <!-- Encode Tab -->
        <div id="encode" class="tab-content active">
            <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-bold mb-4 text-gray-800">Encode DNA Sequence</h2>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Enter your DNA sequence (A, T, C, G nucleotides only)
                    </label>
                    <textarea 
                        id="encodeInput" 
                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        rows="4" 
                        placeholder="ATCGATCGATCG..."
                    ></textarea>
                </div>
                <button 
                    onclick="encodeSequence()" 
                    class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-colors duration-200"
                >
                    Encode Sequence
                </button>
            </div>

            <div id="encodeResults" class="bg-white rounded-lg shadow-lg p-6" style="display: none;">
                <h3 class="text-xl font-bold mb-4 text-gray-800">Encoding Results</h3>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Numerical representation with tandem repeat patterns
                    </label>
                    <div id="encodedOutput" class="p-3 bg-gray-50 border rounded-lg font-mono text-sm"></div>
                </div>
                
                <!-- Download Buttons -->
                <div class="flex flex-wrap gap-3 mb-4">
                    <button 
                        onclick="downloadResults('complete')" 
                        class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200"
                    >
                        Download Complete Format
                    </button>
                    <button 
                        onclick="downloadResults('fractions')" 
                        class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200"
                    >
                        Download Fractions Only
                    </button>
                </div>

                <div id="encodeStats" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4"></div>
                <div id="encodeRepeats"></div>
            </div>
        </div>

        <!-- Decode Tab -->
        <div id="decode" class="tab-content">
            <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-bold mb-4 text-gray-800">Decode Numerical Sequence</h2>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Enter encoded sequence (e.g., "4 2/9, 3, 2 57/99")
                    </label>
                    <textarea 
                        id="decodeInput" 
                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        rows="4" 
                        placeholder="4 2/9, 3, 2 57/99..."
                    ></textarea>
                </div>
                <button 
                    onclick="decodeSequence()" 
                    class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-colors duration-200"
                >
                    Decode Sequence
                </button>
            </div>

            <div id="decodeResults" class="bg-white rounded-lg shadow-lg p-6" style="display: none;">
                <h3 class="text-xl font-bold mb-4 text-gray-800">Decoding Results</h3>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Decoded DNA sequence
                    </label>
                    <div id="decodedOutput" class="p-3 bg-gray-50 border rounded-lg font-mono text-sm break-all"></div>
                </div>
                <div id="decodeStats" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
            </div>
        </div>

        <!-- Validate Tab -->
        <div id="validate" class="tab-content">
            <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-bold mb-4 text-gray-800">Validate Round-trip Encoding</h2>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Enter DNA sequence to validate encoding/decoding consistency
                    </label>
                    <textarea 
                        id="validateInput" 
                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        rows="4" 
                        placeholder="ATCGATCGATCG..."
                    ></textarea>
                </div>
                <button 
                    onclick="validateSequence()" 
                    class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-colors duration-200"
                >
                    Validate Sequence
                </button>
            </div>

            <div id="validateResults" class="bg-white rounded-lg shadow-lg p-6" style="display: none;">
                <h3 class="text-xl font-bold mb-4 text-gray-800">Validation Results</h3>
                <div id="validationStatus" class="mb-4"></div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Original</label>
                        <div id="originalSequence" class="p-3 bg-gray-50 border rounded-lg font-mono text-sm break-all"></div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Encoded</label>
                        <div id="encodedSequence" class="p-3 bg-gray-50 border rounded-lg font-mono text-sm"></div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Decoded</label>
                        <div id="decodedSequence" class="p-3 bg-gray-50 border rounded-lg font-mono text-sm break-all"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mutant Tab -->
        <div id="mutant" class="tab-content">
            <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-bold mb-4 text-gray-800">Mutant Sequence Comparison</h2>
                
                <!-- Reference Sequence -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Reference Sequence (A, T, C, G nucleotides only)
                    </label>
                    <textarea 
                        id="referenceInput" 
                        class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        rows="3" 
                        placeholder="ATCGATCGATCG..."
                    ></textarea>
                </div>

                <!-- Sample Sequences -->
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Sample Sequences (1-5 sequences)
                    </label>
                    <div id="sampleInputs">
                        <div class="mb-3">
                            <label class="block text-xs text-gray-500 mb-1">Sample 1:</label>
                            <textarea 
                                class="sample-input w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                rows="2" 
                                placeholder="ATCGATCGATCG..."
                            ></textarea>
                        </div>
                    </div>
                    
                    <div class="flex gap-2 mb-4">
                        <button 
                            onclick="addSampleInput()" 
                            class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg text-sm"
                        >
                            Add Sample
                        </button>
                        <button 
                            onclick="removeSampleInput()" 
                            class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm"
                        >
                            Remove Sample
                        </button>
                    </div>
                </div>

                <button 
                    onclick="compareMutantSequences()" 
                    class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-colors duration-200"
                >
                    Compare Sequences
                </button>
            </div>

            <div id="mutantResults" class="bg-white rounded-lg shadow-lg p-6" style="display: none;">
                <h3 class="text-xl font-bold mb-4 text-gray-800">Comparison Results</h3>
                
                <!-- Reference Info -->
                <div class="mb-6 p-4 bg-blue-50 rounded-lg">
                    <h4 class="font-semibold text-blue-800 mb-2">Reference Sequence</h4>
                    <div class="mb-2">
                        <span class="text-sm text-gray-600">Sequence: </span>
                        <span id="refSequenceDisplay" class="font-mono text-sm break-all"></span>
                    </div>
                    <div>
                        <span class="text-sm text-gray-600">Encoded: </span>
                        <span id="refEncodedDisplay" class="font-mono text-sm"></span>
                    </div>
                </div>

                <!-- Sample Comparisons -->
                <div id="sampleComparisons"></div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = '/api/dna';
        let currentEncodedResult = '';
        let sampleCount = 1;

        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected tab and activate button
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        async function encodeSequence() {
            const sequence = document.getElementById('encodeInput').value.trim();
            if (!sequence) {
                alert('Please enter a DNA sequence');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/encode`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ sequence })
                });

                const data = await response.json();
                
                if (data.success) {
                    currentEncodedResult = data.encoded_result;
                    document.getElementById('encodedOutput').textContent = data.encoded_result;
                    document.getElementById('encodeResults').style.display = 'block';
                    
                    // Display stats
                    const stats = data.stats;
                    document.getElementById('encodeStats').innerHTML = `
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <div class="text-sm text-gray-600">Length</div>
                            <div class="text-2xl font-bold text-blue-600">${stats.length}</div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg">
                            <div class="text-sm text-gray-600">GC Content</div>
                            <div class="text-2xl font-bold text-green-600">${stats.gc_content}%</div>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <div class="text-sm text-gray-600">Repeats</div>
                            <div class="text-2xl font-bold text-purple-600">${stats.repeat_count}</div>
                        </div>
                        <div class="bg-orange-50 p-4 rounded-lg">
                            <div class="text-sm text-gray-600">Coverage</div>
                            <div class="text-2xl font-bold text-orange-600">${stats.repeat_coverage}%</div>
                        </div>
                    `;
                } else {
                    alert('Error: ' + data.error);
                }
            } catch (error) {
                alert('Network error: ' + error.message);
            }
        }

        async function decodeSequence() {
            const encodedSequence = document.getElementById('decodeInput').value.trim();
            if (!encodedSequence) {
                alert('Please enter an encoded sequence');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/decode`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ encoded_sequence: encodedSequence })
                });

                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('decodedOutput').textContent = data.decoded_result;
                    document.getElementById('decodeResults').style.display = 'block';
                    
                    // Display stats
                    const stats = data.stats;
                    document.getElementById('decodeStats').innerHTML = `
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <div class="text-sm text-gray-600">Length</div>
                            <div class="text-2xl font-bold text-blue-600">${stats.length}</div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg">
                            <div class="text-sm text-gray-600">GC Content</div>
                            <div class="text-2xl font-bold text-green-600">${stats.gc_content}%</div>
                        </div>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <div class="text-sm text-gray-600">Processing Time</div>
                            <div class="text-2xl font-bold text-gray-600">${data.processing_time_ms}ms</div>
                        </div>
                    `;
                } else {
                    alert('Error: ' + data.error);
                }
            } catch (error) {
                alert('Network error: ' + error.message);
            }
        }

        async function validateSequence() {
            const sequence = document.getElementById('validateInput').value.trim();
            if (!sequence) {
                alert('Please enter a DNA sequence');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/validate`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ sequence })
                });

                const data = await response.json();
                
                if (data.success) {
                    document.getElementById('validateResults').style.display = 'block';
                    
                    const statusDiv = document.getElementById('validationStatus');
                    if (data.is_valid) {
                        statusDiv.innerHTML = `
                            <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-lg">
                                <strong>✅ Validation Successful!</strong> The sequence encodes and decodes correctly.
                            </div>
                        `;
                    } else {
                        statusDiv.innerHTML = `
                            <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg">
                                <strong>❌ Validation Failed!</strong> The decoded sequence doesn't match the original.
                            </div>
                        `;
                    }
                    
                    document.getElementById('originalSequence').textContent = data.original;
                    document.getElementById('encodedSequence').textContent = data.encoded;
                    document.getElementById('decodedSequence').textContent = data.decoded;
                } else {
                    alert('Error: ' + data.error);
                }
            } catch (error) {
                alert('Network error: ' + error.message);
            }
        }

        async function downloadResults(format) {
            if (!currentEncodedResult) {
                alert('Please encode a sequence first');
                return;
            }

            let content = currentEncodedResult;
            let filename = 'dna_encoded_complete.txt';

            if (format === 'fractions') {
                try {
                    const response = await fetch(`${API_BASE}/download-fractions`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ encoded_sequence: currentEncodedResult })
                    });

                    const data = await response.json();
                    
                    if (data.success) {
                        content = data.fractions_only;
                        filename = 'dna_encoded_fractions_only.txt';
                    } else {
                        alert('Error getting fractions format: ' + data.error);
                        return;
                    }
                } catch (error) {
                    alert('Network error: ' + error.message);
                    return;
                }
            }

            // Create and download file
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Mutant comparison functions
        function addSampleInput() {
            if (sampleCount >= 5) {
                alert('Maximum 5 sample sequences allowed');
                return;
            }
            
            sampleCount++;
            const sampleInputs = document.getElementById('sampleInputs');
            const newInput = document.createElement('div');
            newInput.className = 'mb-3';
            newInput.innerHTML = `
                <label class="block text-xs text-gray-500 mb-1">Sample ${sampleCount}:</label>
                <textarea 
                    class="sample-input w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    rows="2" 
                    placeholder="ATCGATCGATCG..."
                ></textarea>
            `;
            sampleInputs.appendChild(newInput);
        }

        function removeSampleInput() {
            if (sampleCount <= 1) {
                alert('At least one sample sequence is required');
                return;
            }
            
            const sampleInputs = document.getElementById('sampleInputs');
            const lastInput = sampleInputs.lastElementChild;
            if (lastInput) {
                sampleInputs.removeChild(lastInput);
                sampleCount--;
            }
        }

        function formatAlignmentWithHighlighting(alignment) {
            let refHtml = '';
            let sampleHtml = '';
            
            for (const pos of alignment) {
                if (pos.is_different) {
                    refHtml += `<span class="bg-red-100 text-red-800 font-bold px-1">${pos.reference}</span>`;
                    sampleHtml += `<span class="bg-red-100 text-red-800 font-bold px-1">${pos.sample}</span>`;
                } else {
                    refHtml += `<span class="text-gray-700">${pos.reference}</span>`;
                    sampleHtml += `<span class="text-gray-700">${pos.sample}</span>`;
                }
            }
            
            return { refHtml, sampleHtml };
        }

        async function compareMutantSequences() {
            const referenceSequence = document.getElementById('referenceInput').value.trim();
            const sampleInputs = document.querySelectorAll('.sample-input');
            
            if (!referenceSequence) {
                alert('Please enter a reference sequence');
                return;
            }

            const sampleSequences = [];
            for (const input of sampleInputs) {
                const value = input.value.trim();
                if (value) {
                    sampleSequences.push(value);
                }
            }

            if (sampleSequences.length === 0) {
                alert('Please enter at least one sample sequence');
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/mutant-compare`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ 
                        reference_sequence: referenceSequence,
                        sample_sequences: sampleSequences
                    })
                });

                const data = await response.json();
                
                if (data.success) {
                    // Display reference info
                    document.getElementById('refSequenceDisplay').textContent = data.reference_sequence;
                    document.getElementById('refEncodedDisplay').textContent = data.reference_encoded;
                    
                    // Display sample comparisons
                    const comparisonsDiv = document.getElementById('sampleComparisons');
                    comparisonsDiv.innerHTML = '';
                    
                    for (const comparison of data.comparisons) {
                        const { refHtml, sampleHtml } = formatAlignmentWithHighlighting(comparison.alignment);
                        
                        const comparisonDiv = document.createElement('div');
                        comparisonDiv.className = 'mb-8 p-4 border border-gray-200 rounded-lg';
                        
                        comparisonDiv.innerHTML = `
                            <h5 class="font-semibold text-lg mb-4 text-gray-800">Sample ${comparison.sample_id}</h5>
                            
                            <!-- Statistics -->
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
                                <div class="bg-blue-50 p-3 rounded-lg text-center">
                                    <div class="text-sm text-gray-600">Similarity</div>
                                    <div class="text-xl font-bold text-blue-600">${comparison.statistics.similarity_percentage}%</div>
                                </div>
                                <div class="bg-red-50 p-3 rounded-lg text-center">
                                    <div class="text-sm text-gray-600">Differences</div>
                                    <div class="text-xl font-bold text-red-600">${comparison.statistics.different_positions}</div>
                                </div>
                                <div class="bg-orange-50 p-3 rounded-lg text-center">
                                    <div class="text-sm text-gray-600">Substitutions</div>
                                    <div class="text-xl font-bold text-orange-600">${comparison.statistics.substitutions}</div>
                                </div>
                                <div class="bg-purple-50 p-3 rounded-lg text-center">
                                    <div class="text-sm text-gray-600">Indels</div>
                                    <div class="text-xl font-bold text-purple-600">${comparison.statistics.indels}</div>
                                </div>
                            </div>
                            
                            <!-- Sequence Alignment -->
                            <div class="mb-4">
                                <h6 class="font-medium mb-2">Sequence Alignment (differences in red):</h6>
                                <div class="bg-gray-50 p-3 rounded-lg">
                                    <div class="mb-2">
                                        <span class="text-sm text-gray-600">Reference: </span>
                                        <div class="font-mono text-sm break-all">${refHtml}</div>
                                    </div>
                                    <div>
                                        <span class="text-sm text-gray-600">Sample ${comparison.sample_id}: </span>
                                        <div class="font-mono text-sm break-all">${sampleHtml}</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Numerical Encoding Comparison -->
                            <div class="mb-4">
                                <h6 class="font-medium mb-2">Numerical Encoding:</h6>
                                <div class="bg-gray-50 p-3 rounded-lg">
                                    <div class="mb-2">
                                        <span class="text-sm text-gray-600">Reference: </span>
                                        <span class="font-mono text-sm">${data.reference_encoded}</span>
                                    </div>
                                    <div>
                                        <span class="text-sm text-gray-600">Sample ${comparison.sample_id}: </span>
                                        <span class="font-mono text-sm">${comparison.sample_encoded}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Numerical Differences -->
                            ${comparison.numerical_differences.length > 0 ? `
                                <div class="mb-4">
                                    <h6 class="font-medium mb-2">Pattern Changes:</h6>
                                    <div class="overflow-x-auto">
                                        <table class="min-w-full bg-white border border-gray-200 rounded-lg">
                                            <thead class="bg-gray-50">
                                                <tr>
                                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Pattern</th>
                                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Nucleotide</th>
                                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Reference</th>
                                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Sample</th>
                                                    <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Change</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                ${comparison.numerical_differences.map(diff => `
                                                    <tr class="border-t">
                                                        <td class="px-4 py-2 font-mono text-sm">${diff.pattern}</td>
                                                        <td class="px-4 py-2 font-mono text-sm">${diff.nucleotide_sequence}</td>
                                                        <td class="px-4 py-2 text-sm">${diff.reference_count}</td>
                                                        <td class="px-4 py-2 text-sm">${diff.sample_count}</td>
                                                        <td class="px-4 py-2 text-sm">
                                                            <span class="px-2 py-1 rounded text-xs font-medium ${diff.change_type === 'gain' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                                                                ${diff.change_type === 'gain' ? '+' : ''}${diff.difference}
                                                            </span>
                                                        </td>
                                                    </tr>
                                                `).join('')}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            ` : '<div class="text-sm text-gray-500 mb-4">No numerical pattern differences found.</div>'}
                        `;
                        
                        comparisonsDiv.appendChild(comparisonDiv);
                    }
                    
                    document.getElementById('mutantResults').style.display = 'block';
                } else {
                    alert('Error: ' + data.error);
                }
            } catch (error) {
                alert('Network error: ' + error.message);
            }
        }
    </script>
</body>
</html>